<!DOCTYPE html>
<html>

  <head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>shareSDK用于微信登录 - 公会驻地</title>

	<link rel="shortcut icon" href="/styles/images/favicon.jpg">
	<link rel="icon" href="/styles/images/favicon.jpg">

	<link rel="stylesheet" href="/styles/css/index.css">
	<link rel="stylesheet" href="/styles/css/fontawesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="/styles/css/syntax.css">
	<link rel="canonical" href="/2017/12/25/shareSDKuse/">
	<link rel="alternate" type="application/rss+xml" title="公会驻地" href="/feed.xml">
	
	<meta name="keywords" content="shareSDK用于微信登录, 公会驻地, 学而不思则罔;思而不学则殆;生命不止;折腾不休">
	<meta name="description" content="学而不思则罔;思而不学则殆;生命不止;折腾不休">

	<script src="/styles/js/jquery.min.js"></script>
	<!--[if lt IE 9]>
    	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  	<![endif]-->
  	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "//hm.baidu.com/hm.js?94be4b0f9fc5d94cc0d0415ea6761ae9";
		  var s = document.getElementsByTagName("script")[0]; 
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>
  	<style type="text/css">
	  	.docs-content{
	  		margin-bottom: 10px;
	  	}
  	</style>
</head>

  <body class="index">

    <header class="navbar navbar-inverse navbar-fixed-top docs-nav" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="/" class="navbar-brand">
        <img src="/styles/images/logo.jpg">
      </a>
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">    
        <li>
          <a href="/">Home</a>
        </li>
        <li>
          <a href="/categories/">大类分解</a>
        </li>
        <li>
          <a href="/tag">小类内聚</a>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
            <a><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></a>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">关于<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a rel="nofollow" target="_blank" href="https://github.com/anchoriteFili/">Github</a></li>
            <li><a rel="nofollow" target="_blank" href="https://anchoritefili.github.io">关于作者</a></li>
            <li><a rel="nofollow" href="/books">我的书单</a></li>
            <li><a rel="nofollow" href="/reference">推荐博客</a></li>
<!--            <li><a href="/feed.xml">RSS订阅</a></li>-->
            <li class="divider"></li>
            <li><a rel="nofollow" target="_blank" href="http://www.gonghuizhudi.com">个人官网</a></li>
          </ul>
        </li>
      </ul>
    </nav>
  </div>
</header>

    <div class="docs-header" id="content">
  <div class="container">
  	
  		<!--
		    <h1>shareSDK用于微信登录</h1>
		    <p>Post on Dec 25, 2017 by <a href="/about">anchoriteFili</a></p>
		-->
		    <h1>躬身以待方显气度，拧首抬杠略失品格。</h1>
    
  </div>
</div>

    
      
<div class="banner">
  <div class="container">
  	
    	<a href="/categories/#三方应用-ref">三方应用</a>	/
    	<a href="/tag/#swift-ref">swift</a>
    
  </div>
</div>

    

    <div class="container docs-container">
  <div class="row">
    <div class="col-md-3">
      <div class="sidebar hidden-print" role="complementary">
        <div id="navigation">
  <h1>目录</h1>
  <ul class="nav sidenav">
  </ul>
  <div style="height: 200px;width: 200px;">
    <script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=5ytn1ssq6za&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=33" async="async"> 
    </script>
  </div>
</div>

 
      </div>
    </div>
    <div class="col-md-9" role="main">
      <div class="panel docs-content">
        <div class="wrapper">
            <header class="post-header">
              <h1 class="post-title">shareSDK用于微信登录</h1>
              <!--
                <p class="post-meta">Dec 25, 2017</p>
              -->
              <div class="meta">Posted on <span class="postdate">Dec 25, 2017</span> By <a target="_blank" href="http://localhost:4000">anchoriteFili</a></div>
              <br />
            </header>
            <article class="post-content">
              <ul id="markdown-toc">
  <li><a href="#相关链接" id="markdown-toc-相关链接">相关链接</a></li>
  <li><a href="#1-下载相关sdk" id="markdown-toc-1-下载相关sdk">1. 下载相关SDK</a></li>
  <li><a href="#2-将sdk导入到项目" id="markdown-toc-2-将sdk导入到项目">2. 将SDK导入到项目</a></li>
  <li><a href="#3-配置开发环境" id="markdown-toc-3-配置开发环境">3. 配置开发环境</a>    <ul>
      <li><a href="#1-添加依赖库" id="markdown-toc-1-添加依赖库">1&gt; 添加依赖库</a></li>
      <li><a href="#2-在plist中配置环境只包括微信" id="markdown-toc-2-在plist中配置环境只包括微信">2&gt; 在plist中配置环境(只包括微信)</a></li>
      <li><a href="#3-设置other-linker-flags-添加--objc--all_load" id="markdown-toc-3-设置other-linker-flags-添加--objc--all_load">3&gt; 设置Other Linker Flags 添加 -Objc -all_load</a></li>
      <li><a href="#4-在bridging_header中添加头文件" id="markdown-toc-4-在bridging_header中添加头文件">4&gt; 在Bridging_Header中添加头文件</a></li>
      <li><a href="#5-在appdelegate中配置相关环境" id="markdown-toc-5-在appdelegate中配置相关环境">5&gt; 在AppDelegate中配置相关环境</a></li>
      <li><a href="#6-调取获取信息方法" id="markdown-toc-6-调取获取信息方法">6&gt; 调取获取信息方法</a></li>
    </ul>
  </li>
</ul>

<h3 id="相关链接">相关链接</h3>
<hr />

<ul>
  <li><a href="http://wiki.mob.com/快速集成/" target="_blank">http://wiki.mob.com/快速集成/</a><br /></li>
  <li><a href="http://wiki.mob.com/swift调用/" target="_blank">http://wiki.mob.com/swift调用/</a><br /></li>
  <li><a href="http://wiki.mob.com/适配ios-9＋系统/" target="_blank">http://wiki.mob.com/适配ios-9＋系统/</a><br /></li>
  <li><a href="http://blog.csdn.net/jiaxin_1105/article/details/71124371" target="_blank">微信支付接入那些坑1—–unrecognized selector sent to instance</a><br /></li>
  <li><a href="https://github.com/anchoriteFili/ShareSDKTest" target="_blank">Git仓库代码</a><br /></li>
</ul>

<p><img src="/styles/images/2017-12-25-shareSDKUse/1.png" width="80%" /></p>

<h3 id="1-下载相关sdk">1. 下载相关SDK</h3>
<hr />
<ul>
  <li><a href="http://www.mob.com/downloadDetail/ShareSDK/ios">SDK下载地址</a></li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SDK
  | —– Required（ MOB 基础公共库目录 ）
        | —– MOBFoundation.framework：基础功能框架。（必要）
  | —– ShareSDK ( ShareSDK 目录 )
        | —– ShareSDK.framework：核心静态库。（必要）
        | —– Support （ShareSDK 各组件）
              | —– Required （ 必要 ）
                   | —– ShareSDK.bundle：ShareSDK资源文件。（必要）
                   | —– ShareSDKConnector.framework：用于ShareSDK框架与外部框架连接的代理框架插件。（使用第三方SDK时必要。）
              | —– PlatformSDK 第三方平台SDK。（不需要的平台的SDK可直接移除）
              | —– PlatformConnector 对ShareSDKConnector模块架构进行优化，根据平台进行分包。（不需要的平台的库可以移除）
              | —– Optional （ 可选 ）
                    | —– ShareSDKUI.bundle：分享菜单栏和分享编辑页面资源包。（如果自定义这些UI可直接移除）
                    | —– ShareSDKExtension.framework：对ShareSDK功能的扩展框架插件。（主要提供第三方平台登录、 一键分享、截屏分享、摇一摇分享等相关功能。需要使用以上功能时必要。）
                    | —– ShareSDKUI.framework：分享菜单栏和分享编辑页面。（如果自定义这些UI可直接移除）
                    | —– ShareSDKConfigFile.bundle:用xml来初始化或者构造分享参数的资源文件。（用代码来初始化，构造分享参数可直接移除，下载的时候也是可根据自己的要求勾选下载的）
                    | —– ShareSDKConfigFile.framework：用xml来初始化，构造分享参数，使用的分享的方法库。用代码来初始化，构造分享参数可直接移除，下载的时候也是可根据自己的要求勾选下载的）
</code></pre></div></div>

<p><img src="/styles/images/2017-12-25-shareSDKUse/3.png" width="80%" /></p>

<h3 id="2-将sdk导入到项目">2. 将SDK导入到项目</h3>
<hr />
<p>将下载的SDK文件夹拷贝到项目中-&gt;通过addFiles方法将项目导入到项目中
<img src="/styles/images/2017-12-25-shareSDKUse/2.png" width="80%" /></p>

<h3 id="3-配置开发环境">3. 配置开发环境</h3>
<hr />
<ul>
  <li><a href="http://wiki.mob.com/快速集成/">快速集成链接</a></li>
</ul>

<h5 id="1-添加依赖库">1&gt; 添加依赖库</h5>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>libicucore.dylib
libz.dylib
libstdc++.dylib
JavaScriptCore.framework

新浪微博SDK依赖库
ImageIO.framework
libsqlite3.dylib

QQ好友和QQ空间SDK依赖库
libsqlite3.dylib

微信SDK依赖库
libsqlite3.dylib

Instagram需要依赖库
AssetsLibrary.framework
Photos.framework

美拍需要依赖库
AssetsLibrary.framework

</code></pre></div></div>

<h5 id="2-在plist中配置环境只包括微信">2&gt; 在plist中配置环境(只包括微信)</h5>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;key&gt;</span>LSApplicationQueriesSchemes<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;array&gt;</span>
        <span class="nt">&lt;string&gt;</span>wechat<span class="nt">&lt;/string&gt;</span>
        <span class="nt">&lt;string&gt;</span>weixin<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;/array&gt;</span>
    <span class="nt">&lt;key&gt;</span>qq.com<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;dict&gt;</span>
        <span class="nt">&lt;key&gt;</span>NSExceptionAllowsInsecureHTTPLoads<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;true/&gt;</span>
        <span class="nt">&lt;key&gt;</span>NSExceptionRequiresForwardSecrecy<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;false/&gt;</span>
        <span class="nt">&lt;key&gt;</span>NSIncludesSubdomains<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;true/&gt;</span>
    <span class="nt">&lt;/dict&gt;</span>
    <span class="nt">&lt;key&gt;</span>NSAppTransportSecurity<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;dict&gt;</span>
        <span class="nt">&lt;key&gt;</span>NSAllowsArbitraryLoads<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;true/&gt;</span>
        <span class="nt">&lt;key&gt;</span>NSExceptionDomains<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;dict&gt;</span>
            <span class="nt">&lt;key&gt;</span>jpush.cn<span class="nt">&lt;/key&gt;</span>
            <span class="nt">&lt;dict&gt;</span>
                <span class="nt">&lt;key&gt;</span>NSExceptionAllowsInsecureHTTPLoads<span class="nt">&lt;/key&gt;</span>
                <span class="nt">&lt;true/&gt;</span>
                <span class="nt">&lt;key&gt;</span>NSIncludesSubdomains<span class="nt">&lt;/key&gt;</span>
                <span class="nt">&lt;true/&gt;</span>
            <span class="nt">&lt;/dict&gt;</span>
        <span class="nt">&lt;/dict&gt;</span>
    <span class="nt">&lt;/dict&gt;</span>
    <span class="nt">&lt;key&gt;</span>CFBundleURLTypes<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;array&gt;</span>
        <span class="nt">&lt;dict&gt;</span>
            <span class="nt">&lt;key&gt;</span>CFBundleTypeRole<span class="nt">&lt;/key&gt;</span>
            <span class="nt">&lt;string&gt;</span>Editor<span class="nt">&lt;/string&gt;</span>
            <span class="nt">&lt;key&gt;</span>CFBundleURLSchemes<span class="nt">&lt;/key&gt;</span>
            <span class="nt">&lt;array&gt;</span>
                <span class="nt">&lt;string&gt;</span>wx40683bbaae3afdd4<span class="nt">&lt;/string&gt;</span>
            <span class="nt">&lt;/array&gt;</span>
        <span class="nt">&lt;/dict&gt;</span>
    <span class="nt">&lt;/array&gt;</span>
    <span class="nt">&lt;key&gt;</span>MOBAppKey<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;string&gt;</span>a6cf409fc610<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;key&gt;</span>MOBAppSecret<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;string&gt;</span>60dbc04e6b16d2983056ae5be9b942f5<span class="nt">&lt;/string&gt;</span>
</code></pre></div></div>

<h5 id="3-设置other-linker-flags-添加--objc--all_load">3&gt; 设置Other Linker Flags 添加 -Objc -all_load</h5>

<p><img src="/styles/images/2017-12-25-shareSDKUse/1.png" width="80%" /></p>

<blockquote>
  <p>－ObjC：加了这个参数后，链接器就会把静态库中所有的Objective-C类和分类都加载到最后的可执行文件中</p>

  <p>－all_load：会让链接器把所有找到的目标文件都加载到可执行文件中，但是千万不要随便使用这个参数！假如你使用了不止一个静态库文件，然后又使用了这个参数，那么你很有可能会遇到ld: duplicate symbol错误，因为不同的库文件里面可能会有相同的目标文件，所以建议在遇到-ObjC失效的情况下使用-force_load参数。</p>

  <p>-force_load：所做的事情跟-all_load其实是一样的，但是-force_load需要指定要进行全部加载的库文件的路径，这样的话，你就只是完全加载了一个库文件，不影响其余库文件的按需加载</p>
</blockquote>

<h5 id="4-在bridging_header中添加头文件">4&gt; 在Bridging_Header中添加头文件</h5>

<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#import &lt;ShareSDK/ShareSDK.h&gt;
#import &lt;ShareSDKUI/ShareSDK+SSUI.h&gt;
#import &lt;ShareSDKConnector/ShareSDKConnector.h&gt;
</span>
<span class="c1">//腾讯开放平台（对应QQ和QQ空间）SDK头文件
</span><span class="cp">#import &lt;TencentOpenAPI/TencentOAuth.h&gt;
#import &lt;TencentOpenAPI/QQApiInterface.h&gt;
</span>
<span class="c1">//微信SDK头文件
</span><span class="cp">#import "WXApi.h"
</span><span class="c1">// 三方登录头文件
</span><span class="cp">#import &lt;ShareSDKExtension/SSEThirdPartyLoginHelper.h&gt;
</span></code></pre></div></div>

<h5 id="5-在appdelegate中配置相关环境">5&gt; 在AppDelegate中配置相关环境</h5>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/************************ shareSDK begin******************************/</span>
    <span class="kd">func</span> <span class="nf">setUpShareSDK</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">ShareSDK</span><span class="o">.</span><span class="nf">registerActivePlatforms</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="kt">SSDKPlatformType</span><span class="o">.</span><span class="n">typeWechat</span><span class="o">.</span><span class="n">rawValue</span><span class="p">,</span>
                <span class="kt">SSDKPlatformType</span><span class="o">.</span><span class="n">typeQQ</span><span class="o">.</span><span class="n">rawValue</span>
            <span class="p">],</span>
            <span class="nv">onImport</span><span class="p">:</span> <span class="p">{(</span><span class="nv">platform</span> <span class="p">:</span> <span class="kt">SSDKPlatformType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
                <span class="k">switch</span> <span class="n">platform</span> <span class="p">{</span>
                <span class="k">case</span> <span class="kt">SSDKPlatformType</span><span class="o">.</span><span class="nv">typeWechat</span><span class="p">:</span>
                    <span class="kt">ShareSDKConnector</span><span class="o">.</span><span class="nf">connectWeChat</span><span class="p">(</span><span class="kt">WXApi</span><span class="o">.</span><span class="nf">classForCoder</span><span class="p">())</span>
                <span class="k">case</span> <span class="kt">SSDKPlatformType</span><span class="o">.</span><span class="nv">typeQQ</span><span class="p">:</span>
                    <span class="kt">ShareSDKConnector</span><span class="o">.</span><span class="nf">connectQQ</span><span class="p">(</span><span class="kt">QQApiInterface</span><span class="o">.</span><span class="nf">classForCoder</span><span class="p">(),</span> <span class="nv">tencentOAuthClass</span><span class="p">:</span> <span class="kt">TencentOAuth</span><span class="o">.</span><span class="nf">classForCoder</span><span class="p">())</span>
                <span class="k">default</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="p">}</span>
        <span class="p">},</span>
            <span class="nv">onConfiguration</span><span class="p">:</span> <span class="p">{(</span><span class="nv">platform</span> <span class="p">:</span> <span class="kt">SSDKPlatformType</span> <span class="p">,</span> <span class="nv">appInfo</span> <span class="p">:</span> <span class="kt">NSMutableDictionary</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
                <span class="k">switch</span> <span class="n">platform</span> <span class="p">{</span>
                <span class="k">case</span> <span class="kt">SSDKPlatformType</span><span class="o">.</span><span class="nv">typeWechat</span><span class="p">:</span>
                    <span class="c1">//设置微信应用信息</span>
                    <span class="n">appInfo</span><span class="p">?</span><span class="o">.</span><span class="nf">ssdkSetupWeChat</span><span class="p">(</span><span class="nv">byAppId</span><span class="p">:</span> <span class="s">"wx40683bbaae3afdd4"</span><span class="p">,</span>
                                             <span class="nv">appSecret</span><span class="p">:</span> <span class="s">"e26439a5d0cc2ed60ee37a93daa85755"</span><span class="p">)</span>
                <span class="k">case</span> <span class="kt">SSDKPlatformType</span><span class="o">.</span><span class="nv">typeQQ</span><span class="p">:</span>
                    <span class="c1">//设置QQ应用信息</span>
                    <span class="n">appInfo</span><span class="p">?</span><span class="o">.</span><span class="nf">ssdkSetupQQ</span><span class="p">(</span><span class="nv">byAppId</span><span class="p">:</span> <span class="s">"100371282"</span><span class="p">,</span>
                                         <span class="nv">appKey</span><span class="p">:</span> <span class="s">"aed9b0303e3ed1e27bae87c33761161d"</span><span class="p">,</span>
                                         <span class="nv">authType</span><span class="p">:</span> <span class="kt">SSDKAuthTypeWeb</span><span class="p">)</span>
                <span class="k">default</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="p">}</span>
        <span class="p">})</span>
    <span class="p">}</span>
    <span class="cm">/************************ shareSDK end******************************/</span>
</code></pre></div></div>

<h5 id="6-调取获取信息方法">6&gt; 调取获取信息方法</h5>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">ShareSDK</span><span class="o">.</span><span class="nf">getUserInfo</span><span class="p">(</span><span class="o">.</span><span class="n">typeWechat</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">SSDKResponseState</span><span class="p">,</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">SSDKUser</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">Error</span><span class="p">?)</span> <span class="k">in</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">u</span> <span class="o">=</span> <span class="n">user</span> <span class="p">{</span>
       <span class="c1">// 如果有相关信息</span>
       <span class="nf">print</span><span class="p">(</span><span class="s">"user ************* </span><span class="se">\(</span><span class="n">u</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>


            </article>
        </div>
      </div>
    </div>
  </div>
</div>

    
    <footer class="footer" role="contentinfo">
	<div class="container">
		<p class="copyright">Copyright &copy; 2014-2018 <a href="https://anchoritefili.github.io"><code>anchoriteFili</code></a>.</p>
		<p>Powered by <a href="http://jekyllrb.com">Jekyll</a>, themed from <a href="http://lesscss.cn/">Less</a>, refactored by <a href="http://www.hifreud.com/">Freud Kang</a></p>
	</div>
</footer>

<script src="/styles/js/jquery.min.js"></script>
<script src="/styles/js/bootstrap.min.js"></script>
<script src="/styles/js/holder.min.js"></script>
<script src="/styles/js/lessismore.js"></script>
<script src="/styles/js/application.js"></script>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  </body>
</html>
